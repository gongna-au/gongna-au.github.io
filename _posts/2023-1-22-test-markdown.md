---
layout: post
title: 分布式一致性协议Gossip和Redis 集群原理解析
subtitle: Gossip-分布式协议、Redis Cluster 原理、Codis 分布式方案
tags: [Gossip]
comments: true
---

### 1. Redis 单机模式

顾名思义，单机模式指 Redis 主节点以单个节点的形式存在，这个主节点可读可写，上面存储数据全集。在 3.0 版本之前，Redis 只能支持单机模式，出于可靠性考量，通常单机模式为“1 主 N 备”的结构，如下所示：

> 单机模式不支持自动故障转移（指的是主节点故障的时候，副节点不可以升主），扩容能力有限

需要说明的是，即便有很多个 Redis 主节点，只要这些主节点以单机模式存在，本质上仍为单机模式。单机模式比较简单，足以支撑一般应用场景，但单机模式具有固有的局限性：不支持自动故障转移，扩容能力极为有限（只能 Scale Up，垂直扩容），存在高并发瓶颈。

### 1.1 Sentinel-System（哨兵系统）

> Sentinel-System（哨兵系统）由一个或者多个 sentinel 实例组成，可以监控 Redis 的主节点以及从节点

> Sentinel-System（哨兵系统）是 Redis 的一个的高可用方案

当由一个或者多个 sentinel 实例组成的 Sentinel-System（哨兵系统）监控到 Redis 的主节点下线的时候，会根据特定的选举规则从主节点的从节点中选取一个最优的从节点升主。然后由最新的主节点处理请求。

### 1.2 单机扩容能力极为有限

这一点应该很好理解，单机模式下，只有主节点能够写入数据，那么，最大数据容量就取决于主节点所在物理机的内存容量，而物理机的内存扩容（Scale Up）能力目前仍是极为有限的。
