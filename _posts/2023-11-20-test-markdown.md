---
layout: post
title: 测试之道
subtitle:
tags: [测试]
comments: true
---

### BDD

BDD（行为驱动开发）
本质:
专注于系统行为和业务逻辑。
通常使用自然语言描述，易于非技术人员理解。
将需求和测试紧密结合。
应用场景:
当需要与非技术人员（如产品经理或业务分析师）讨论需求时。
当想强调软件应该做什么，而不是怎么做。

在BDD（行为驱动开发）中，自然语言描述通常遵循“Given-When-Then”的模式。

统一模板：
```text
Feature: [功能描述]

  Scenario: [场景描述]
    Given [前置条件]
    When [操作或事件]
    Then [预期结果]

```

```text
Feature: 计算器的加法功能

  Scenario: 两个正数的加法
    Given 计算器已开启
    When 输入数字 1 和 2 进行加法运算
    Then 结果应为 3

  Scenario: 加法与清零功能
    Given 计算器已开启并显示结果为 3
    When 按下清零键
    Then 显示结果应为 0
```

### TDD

TDD（测试驱动开发）
本质:
先编写测试，然后编写满足测试的最简代码。
侧重于开发过程，而不仅仅是测试。
应用场景:
适用于几乎所有软件项目，特别是新项目。
当想确保的代码能正常工作，并且容易维护。

### MBT
MBT（模型驱动测试）
本质:
使用模型（通常是状态机或图）来描述系统行为。
根据模型自动生成测试用例。
应用场景:
当系统非常复杂，并且状态转换多。
适用于硬件测试，或者需要与硬件交互的软件。
当手动编写和维护测试用例成本过高。
总结：BDD强调业务和行为，TDD强调开发过程，而MBT强调通过模型来自动化和简化测试。根据的项目需求，可能会选择其中一个，或者将它们结合使用。

## 性能分析方法


### Load Testing（负载测试）
优点: 用于模拟多用户并发访问，找出系统在高负载下的性能瓶颈。
缺点: 需要大量的资源和时间来模拟真实环境。

### Profiling（性能剖析）
优点: 可以深入到代码级别，找出性能问题的具体来源。
缺点: 对代码有侵入性，可能会影响系统的正常运行。

### Monitoring（实时监控）
优点: 在生产环境下收集数据，非常接近实际情况。
缺点: 只能发现问题，但不一定能定位问题源。

### Stress Testing（压力测试）
优点: 能找出系统的极限性能。
缺点: 不一定适用于所有场景，且可能会影响现有用户。

### APM Tools（应用性能管理工具）
优点: 提供全面的性能指标，包括延迟、错误率等。
缺点: 通常需要购买商业软件，成本高。

### Database Query Analysis（数据库查询分析）
优点: 针对数据库性能瓶颈进行优化。
缺点: 专注于数据库，可能会忽视其他问题。

### Code Review（代码审查）
优点: 通过人工检查来预防性能问题。
缺点: 很依赖个人经验，可能会漏掉一些非明显的问题。

## JMeter 

概述、安装 JMeter 和插件 - 5:24
第一个构建块 - 7:03
知识检查#1
常用元素 - 线程组 - 5:57
常用元素 - 配置元素 - 9:15
常用元素 - HTTP 请求采样器 - 7:42
知识检查#2
常用元素 - 听众 - 9:21
常用元素 - 控制器 - 第 1 部分 - 8:27
常用元素 - 控制器 - 第 2 部分 - 10:01
知识检查#3
常用元素 - 计时器 - 5:17
节奏与思考时间 - 3:22
范围规则和执行顺序 - 5:44
知识检查#4
利用数据集 - 6:08
JMeter 日志记录 - 4:20
后处理器 - 正则表达式、JSON 路径、边界提取器 - 9:23
使用 HTTP(S) 测试脚本记录器创建脚本 - 7:22
使用 JMeter 变量和属性测试参数化 - 11:23


## Linux相关


理论题/选择题：

> 简要描述Linux三剑客（awk、grep、sed）各自的主要用途。

awk：主要用于文本和数据提取及处理。它可以定义多种文本操作任务，并在文件或输入流中的每一行上执行这些任务。

grep：用于在文本文件中搜索匹配特定模式的行。非常适用于快速文本搜索。

sed：主要用于流式文本编辑，可以对输入的文本进行各种替换、删除、插入等操作。

> 使用awk对给定的文本文件进行特定字段的提取。

假设有一个逗号分隔的文本文件data.csv，内容如下：
```shell
Copy code
John,25,Engineer
Sarah,30,Doctor
```
可以使用下面的awk命令来提取第一个和第三个字段：

```shell
awk -F',' '{print $1, $3}' data.csv
```

> 使用sed进行文本替换。

假设你有一个文本文件text.txt，内容如下：
```shell
Hello World
```
可以使用下面的sed命令来替换"World"为"Universe"：

```shell
sed 's/World/Universe/g' text.txt
```
> 编写一个grep命令，找出包含或不包含某些特定字符串的行。

使用grep找出包含或不包含某些特定字符串的行

假设你有一个文本文件sample.txt，内容如下：
```text
apple
orange
banana
```
找出包含apple的行：

```shell
grep 'apple' sample.txt
```
找出不包含apple的行：
```shell
grep -v 'apple' sample.txt
```
> 什么是iptables？它在网络配置中主要用于什么？

iptables是Linux系统中的一个用户空间工具，用于配置内核防火墙。在网络配置中，它主要用于定义一套规则，控制网络包的转发、接收和发送。

> 编写一个简单的iptables规则来阻止来自特定IP地址的所有网络流量。

```shell
sudo iptables -A INPUT -s 192.168.1.1 -j DROP
```
> 与tcpdump相关的命令是什么，它的作用是什么？

tcpdump：用于捕获和分析网络流量。它可以抓取经过一个网络接口的数据包，并提供详细的信息，如源/目的IP地址、源/目的端口等，以便进行网络诊断或分析。

> 使用tcpdump捕获特定类型的网络包。

例如，要捕获所有来自IP地址192.168.1.1的TCP包，你可以使用以下命令：
```shell
sudo tcpdump tcp and src 192.168.1.1
```

> 列出系统中运行的前5个占用CPU最多的进程。


```shell
ps -eo %cpu,command | sort -k1 -n -r | head -n 6
```
ps -eo %cpu,command: 运行ps命令来显示所有进程的CPU使用率（%cpu）和命令行（command）。

sort -k1 -n -r: 用sort命令按第一个字段（即CPU使用率）进行排序。选项-n表示按数值排序，-r表示逆序（从大到小）。

head -n 6: 使用head命令来只显示排序后的前6行。这里是6行而不是5行，因为第一行通常是列标题。

> 编写一个简单的Shell脚本，用于自动执行一系列的系统监测任务。

```shell
#!/bin/bash
echo "Disk Usage:"
df -h
echo "Memory Usage:"
free -m
echo "CPU Load:"
top -n 1 | grep "load average"
```


> 发现一个服务器突然响应缓慢，你会用哪些命令或方法来诊断问题？

top或htop：查看CPU和内存使用情况。
iotop：检查磁盘I/O。
sudo fs_usage:MacOS不自带iotop工具。可以使用sudo fs_usage来监视文件系统的使用情况，但这不是iotop的直接替代。
netstat：检查网络连接。
dmesg | tail：查看内核日志的最后几行。

> 优化系统或网络性能：

诊断：
使用top和iotop诊断了系统和IO性能。
使用tcpdump和iptables记录来自特定IP地址的网络流量。
数据库查询日志也被审查以找出低效的查询。

解决方案：
优化数据库查询： 发现某些复杂的SQL查询没有使用索引，导致查询效率低下。通过添加索引，查询时间得以显著减少。

网络优化：
发现TCP连接中有大量的TIME_WAIT状态。通过调整/proc/sys/net/ipv4/tcp_tw_reuse和/proc/sys/net/ipv4/tcp_tw_recycle的值，减少了TIME_WAIT连接数。
使用iptables限制了来自某些可疑IP地址的访问，减轻了服务器的负担。
使用缓存： 对于频繁访问的数据库查询结果，使用了Redis作为缓存，进一步减少了数据库的负担。
负载均衡： 为了分散流量，引入了一个负载均衡器，并对其进行了精细的配置。


